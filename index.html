---
layout: default
title: Purdue Parking Map
---
<div id="controls">
  <label>Pass Type: 
    <select id="passType" onchange="filterParking()">
      <option value="">-- Select Pass Type --</option>
    </select>
  </label>

  <label for="building">Destination Building:</label>
  <select id="building" onchange="buildingChanged()" class="select2">
    <option value="">-- Select Building --</option>
  </select>

  <label>
    Handicap Parking:
    <input type="checkbox" id="handicapToggle" checked onchange="toggleHandicapParking()">
  </label>

  <button onclick="filterParking()">Find Parking</button>
</div>

<div id="noLotsMessage">No matching lots found.</div>
<div id="map"></div>

<script>
  function buildingChanged() {
    const selectedAbbr = buildingSelect.value;
    if (!buildingLayer) return;

    selectedBuildingAbbr = selectedAbbr || null;

    if (!selectedAbbr) {
      map.setView([40.4237, -86.9212], 15);
    } else {
      buildingLayer.eachFeature(layer => {
        const props = layer.feature?.properties;
        if (props?.BLDG_ABBR === selectedAbbr) {
          const bounds = layer.getBounds();
          const padding = window.innerWidth > 768 ? [200, 200] : [100, 100];
          map.fitBounds(bounds, { padding });
        }
      });
    }

    buildingLayer.setStyle(buildingLayer.options.style);
    filterParking();
  }

  function toggleHandicapParking() {
    const show = document.getElementById('handicapToggle').checked;
    if (handicapLayer) {
      if (show) {
        map.addLayer(handicapLayer);
      } else {
        map.removeLayer(handicapLayer);
      }
    }
  }

  // Bind event listeners after defining functions
  passTypeSelect.addEventListener('change', filterParking);
  buildingSelect.addEventListener('change', buildingChanged);
  document.getElementById('handicapToggle')?.addEventListener('change', toggleHandicapParking);
</script>

